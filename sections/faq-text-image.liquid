<style>
  .faq-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
  }

  .faq-image-content {
    position: relative;
    overflow: hidden;
    display: flex;
    justify-content: flex-start;
    aspect-ratio: 1 / 1;
  }

  .faq-image {
    object-fit: cover;
    overflow: hidden;
    width: 100%;
  }

  .faq-title {
    font-size: 48px;
    font-weight: bold;
    margin-bottom: 40px;
    line-height: 1.2;
    color: #000;
  }

  .faq-item {
    border-bottom: 1px solid #e5e5e5;
    margin-bottom: 0;
  }

  .faq-question {
    width: 100%;
    background: none;
    border: none;
    padding: 24px 0;
    text-align: left;
    font-size: 16px;
    font-weight: 500;
    color: #000;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.3s ease;
  }

  .faq-question:hover {
    color: #ed4026;
  }

  .faq-question.active {
    color: #ed4026;
  }

  .faq-icon {
    font-size: 16px;
    transition: transform 0.3s ease;
    color: #666;
  }

  .faq-question.active .faq-icon {
    transform: rotate(45deg);
    color: #ed4026;
  }

  .faq-answer {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
    background: transparent;
  }

  .faq-answer.active {
    max-height: 300px;
  }

  .faq-answer-content {
    padding: 0 0 24px 0;
    color: #333;
    line-height: 1.6;
  }

  .faq-load-more {
    margin-top: 30px;
  }

  .faq-load-more-btn {
    background: none;
    border: none;
    color: #000;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    text-decoration: underline;
    padding: 0;
    transition: color 0.3s ease;
  }

  .faq-load-more-btn:hover {
    color: #ed4026;
  }

  .faq-container {
    align-items: center;
  }

  @media (max-width: 768px) {
    .faq-container {
      grid-template-columns: 1fr;
      gap: 40px;
    }

    .faq-image {
      height: 400px;
    }

    .faq-title {
      font-size: 36px;
      margin-bottom: 30px;
    }

    .faq-question {
      padding: 20px 0;
      font-size: 15px;
    }
  }
</style>

<section class="faq-section">
  <div class="">
    <div class="faq-container">
      <!-- Image Side -->
      <div class="faq-image-content">
        {% if section.settings.image != blank %}
          <img
            src="{{ section.settings.image | image_url: width: 800 }}"
            alt="{{ section.settings.image.alt | escape }}"
            class="faq-image"
            width="800"
            height="600"
            loading="lazy"
          >
        {% else %}
          <div
            class="faq-image"
            style="background: #f5f5f5; display: flex; align-items: center; justify-content: center; color: #999;"
          >
            <span>Add FAQ Image</span>
          </div>
        {% endif %}
      </div>

      <!-- FAQ Content -->
      <div class="faq-text-content p-20">
        {% if section.settings.title != blank %}
          <h2 class="faq-title">{{ section.settings.title }}</h2>
        {% endif %}

        <div class="faq-list">
          {% for block in section.blocks %}
            {% case block.type %}
              {% when 'faq_item' %}
                <div class="faq-item" {{ block.shopify_attributes }}>
                  <button class="faq-question font-second-semibold">
                    <span>{{ block.settings.question }}</span>
                    <span class="faq-icon">+</span>
                  </button>
                  <div class="faq-answer">
                    <div class="faq-answer-content font-first text-[#333] text-lg">
                      {{ block.settings.answer }}
                    </div>
                  </div>
                </div>
            {% endcase %}
          {% endfor %}
        </div>

        {% if section.settings.show_load_more %}
          <div class="faq-load-more">
            <button class="faq-load-more-btn">
              {{ section.settings.load_more_text | default: 'Load More' }}
            </button>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const faqQuestions = document.querySelectorAll('.faq-question');
    const loadMoreBtn = document.querySelector('.faq-load-more-btn');

    function toggleFAQ(button) {
      const faqItem = button.closest('.faq-item');
      const answer = faqItem.querySelector('.faq-answer');
      const isActive = button.classList.contains('active');

      // Đóng tất cả item khác
      faqQuestions.forEach(q => {
        q.classList.remove('active');
        q.closest('.faq-item').querySelector('.faq-answer').classList.remove('active');
      });

      // Mở item được click
      if (!isActive) {
        button.classList.add('active');
        answer.classList.add('active');
      }
    }

    faqQuestions.forEach(btn => {
      btn.addEventListener('click', function() {
        toggleFAQ(this);
      });
    });

    if (loadMoreBtn) {
      loadMoreBtn.addEventListener('click', function() {
        const hiddenItems = document.querySelectorAll('.faq-item[style*="display: none"]');
        hiddenItems.forEach((item, index) => {
          if (index < 3) {
            item.style.display = 'block';
          }
        });
        if (hiddenItems.length <= 3) {
          document.querySelector('.faq-load-more').style.display = 'none';
        }
      });
    }

    // Nếu bật tùy chọn "mở câu đầu tiên"
    {% if section.settings.open_first_item %}
      const firstQuestion = document.querySelector('.faq-question');
      if (firstQuestion) {
        toggleFAQ(firstQuestion);
      }
    {% endif %}
  });
</script>

{% schema %}
{
  "name": "FAQ with Image",
  "tag": "section",
  "class": "faq-section",
  "settings": [
    {
      "type": "header",
      "content": "FAQ Section Settings"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "FAQ Image",
      "info": "Recommended size: 800x600px"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "FAQ"
    },
    {
      "type": "checkbox",
      "id": "open_first_item",
      "label": "Open first FAQ item by default",
      "default": false
    },
    {
      "type": "header",
      "content": "Load More Settings"
    },
    {
      "type": "checkbox",
      "id": "show_load_more",
      "label": "Show Load More Button",
      "default": false
    },
    {
      "type": "text",
      "id": "load_more_text",
      "label": "Load More Button Text",
      "default": "Load More"
    }
  ],
  "blocks": [
    {
      "type": "faq_item",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "Your question here?"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Your detailed answer goes here.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ with Image",
      "blocks": [
        {
          "type": "faq_item",
          "settings": {
            "question": "01. How do I use the Hair Oil?",
            "answer": "<p>Apply a few drops to your scalp and hair, then massage gently. Use 2-3 times per week for best results.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "02. Can I use it as a leave-in treatment?",
            "answer": "<p>Yes, you can use it as a leave-in treatment. Apply a small amount to damp hair before styling.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "03. Will it leave my hair greasy?",
            "answer": "<p>No, when used as directed, it absorbs quickly without leaving a greasy residue.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "04. What is the difference between all the hair oils?",
            "answer": "<p>Each oil is formulated for different hair types and concerns. Check the product descriptions for specific benefits.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "05. Can I use it on my hair lengths?",
            "answer": "<p>For best results, we recommend using the HoliRoots Hair Oil only on the scalp.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}
